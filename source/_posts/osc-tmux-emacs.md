title: 一流的人体工程学
date: 2016-11-15
tags:
- i3
- urxvt
- tmux
- emacs
- osc52
- copyq
categories: ergonomics
---

<video src="/videos/dango.webm" width="480" height="360" controls></video>

```perl
#!/usr/bin/env perl

use MIME::Base64;
use Encode;

sub on_osc_seq {
  my ($term, $op, $args) = @_;
  return () unless $op eq 52;
  my ($clip, $data) = split ';', $args, 2;
  if ($data eq '?') {
    my $data_free = $term->selection();
    Encode::_utf8_off($data_free);
    $term->tt_write("\e]52;$clip;".encode_base64($data_free, '')."\a");
  }
  elsif ($clip =~ /x/) {
    my $data_decoded = decode_base64($data);
    Encode::_utf8_on($data_decoded);
    my $host_name = $term->resource('title');
    $data_decoded =~ s/^\/$host_name://;
    $term->exec_async('ssh', $host_name, 'emacsclient -n',  $data_decoded);
    $term->exec_async('i3-msg focus right');
  }
  else {
    my $data_decoded = decode_base64($data);
    Encode::_utf8_on($data_decoded);
    $term->selection($data_decoded, $clip =~ /c/);
    $term->selection_grab(urxvt::CurrentTime, $clip =~ /c/);
  }
  ()
}
```

```rc
# cannot be used outside tmux
function vi() {
  if [ $# -ne 1 ]; then
      echo "Usage: $0 <filename>"
      exit 1
  fi
  max=74994
  file=$1
  if [[ -d $file || -f $file ]]; then
      buf="/`hostname`:`readlink -f $file`"
      esc="\033]52;x;$( printf %s "$buf" | head -c $max | base64 | tr -d '\r\n' )\a"
      esc="\033Ptmux;\033$esc\033\\" # tmux
      printf "$esc"
  else
      echo "Filename is invalid."
  fi
}
alias vim=vi
```
[sshrc](https://github.com/Russell91/sshrc)

```rc
HISTFILESIZE=100000
HISTSIZE=100000
# ignore insane bash inputs
HISTIGNORE=????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????????*
HISTCONTROL=ignoreboth:erasedups
shopt -s histappend

export PS1="[\w]$ "
export MANPATH=/home/amos/share/man:$MANPATH
export INFOPATH=/home/amos/share/info:$INFOPATH
export PATH=/home/amos/bin:$PATH
export LIBRARY_PATH=/home/amos/lib:$LIBRARY_PATH
export LD_LIBRARY_PATH=/home/amos/lib:$LD_LIBRARY_PATH
export USE_GOLD_LINKER=true

eval "$(fasd --init auto)"

alias j='fasd_cd -d'
alias make='bear make'
alias ssh='sshrc'
source /home/amos/.sshrc
```

```tmux
set -g mode-keys vi
bind -Tcopy-mode-vi Escape send -X copy-selection-and-cancel
unbind -Tcopy-mode-vi MouseDragEnd1Pane

bind -n DoubleClick1Pane copy-mode\; send -X select-word
bind -Tcopy-mode-vi TripleClick1Pane send -X select-line
set -g set-titles off
#osc52
set -g terminal-overrides '*88col*:colors=88,*256col*:colors=256,xterm*:XT:Ms=\E]52;%p1%s;%p2%s\007,rxvt-uni*:XT:Ms=\E]52;%p1%s;%p2%s\007'
set -g mouse on
set -g prefix C-x
set -g prefix2 C-x
bind C-x send-prefix
bind s set synchronize-panes
bind C-c detach-client
set -g status-interval 1     # redraw status line every 10 seconds
# switch windows alt+number
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

bind -n M-h select-pane -L  # move left
bind -n M-j select-pane -D  # move down
bind -n M-k select-pane -U  # move up
bind -n M-l select-pane -R  # move right

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @continuum-restore 'on'

run '~/.tmux/plugins/tpm/tpm'
```

`dotspacemacs-auto-resume-layouts t`

```elisp
(defcustom osc52-max-sequence 100000)
(defun osc52-select-text (string &optional replace yank-handler)
  (let ((b64-length (+ (* (length string) 3) 2)))
    (if (<= b64-length osc52-max-sequence)
        (send-string-to-terminal
         (concat "\e]52;c;"
                 (base64-encode-string (encode-coding-string string 'utf-8) t)
                 "\07"))
        (message "Selection too long to send to terminal %d" b64-length)
        (sit-for 2))))
(defun osc52-set-cut-function ()
  (if (not window-system) (setq interprogram-cut-function 'osc52-select-text)))
(osc52-set-cut-function)
```

```
#!/usr/bin/env bash

urxvt -title nobida201 -e ssh nobida201 -t "tmux new -s amos || tmux a -t amos" &
urxvt -title nobida201 -e ssh nobida201 -t "emacsclient -c" &
```

```i3
workspace_layout tabbed
assign [class="URxvt" title="nobida201"] $workspace2
for_window [class="URxvt" title="nobida201"] focus
bindsym control+mod1+comma focus left
bindsym control+mod1+period focus right
```

```
evdev:atkbd:dmi:bvn*:bvr*:bd*:svnLENOVO*:pn*:pvrThinkPadT450s*
  KEYBOARD_KEY_b7=247
  KEYBOARD_KEY_b8=leftctrl
```

```
keycode 255 = Hyper_L Hyper_L Hyper_L Hyper_L
remove Mod4 = Hyper_L
add Mod3 = Hyper_L
```


[patch](https://github.com/alols/xcape/pull/70)
`xcape -e 'Alt_L:Control_L=Right;Control_L:Alt_L=Left;Control_L=Escape;Hyper_L=Shift_L|Insert'`

```rc
mod3+f
  copyq toggle
mod3+p 
  teiler --quickcopy area
mod3+shift+p 
  teiler --quick area
mod3+t 
  teiler --paste
mod3+r 
  teiler --togglecast
mod3+g 
  /home/amos/scripts/search_clip
mod3+s 
  /home/amos/scripts/scholar_clip
```
`sxhkd &`
